## 背景信息
---

利用 Tmux 创建稳定的 SSH 连接，核心在于利用其 **会话持久化** 功能。这能确保即使您的本地 SSH 客户端因网络波动或电脑休眠而断开，在远程服务器上运行的任务也不会中断，仍会在后台安全执行。

等您重新连接后，可以无缝恢复到之前的工作现场。

下面这个表格汇总了实现这一目标的核心操作和概念，方便您快速查阅。

| **核心目标**     | **关键命令/操作**                | **简要说明**                                                |
| :--------------- | :------------------------------- | :---------------------------------------------------------- |
| **创建新会话**   | `tmux new -s <session_name>`     | 创建一个指定名称的新会话，便于后续识别和重连。              |
| **从会话中分离** | 先按 `Ctrl`+ `b`，松开后再按 `d` | 使会话在服务器后台运行，而不会关闭。此时您可以安全断开SSH。 |
| **列出所有会话** | `tmux ls`                        | 查看当前在后台运行的所有Tmux会话列表。                      |
| **重新连接会话** | `tmux attach -t <session_name>`  | 重新连接到某个特定的已存在会话。                            |

### 🔧 详细操作步骤

1. **安装 Tmux**

   首先，确保在您的远程服务器上安装了 Tmux。您可以使用系统包管理器进行安装：

   - 对于 Debian/Ubuntu 系统：`sudo apt-get install tmux`

   - 对于 RHEL/CentOS 系统：`sudo yum install tmux`


2. **创建并管理持久化会话**

   - **创建新会话**：SSH登录服务器后，使用 `tmux new -s my_work`这样的命令创建一个名为 `my_work`的会话。这相当于开启了一个不受当前SSH连接生命周期影响的新工作空间

   - **在会话中工作**：此后，这个 Tmux 会话中运行的所有命令（例如编译代码、训练模型）都会在其中执行。

   - **分离会话**：当您需要暂时离开（比如关闭笔记本电脑），不必结束任务。只需按下前缀键 `Ctrl`+ `b`，然后松开再按 `d`，即可从当前会话中“分离”（detach）。此时您会看到终端提示符，可以直接断开SSH，而任务将继续在服务器上运行

   - **重连会话**：下次需要继续工作时，重新通过SSH登录服务器，然后使用 `tmux attach -t my_work`命令就能完美恢复到之前的工作界面，所有运行中的进程和输出都保持原样


3. **进阶管理与技巧**

   - **会话复用与多任务**：可以为不同项目创建多个会话（如 `tmux new -s web_server`、`tmux new -s data_analysis`），并通过 `tmux ls`查看它们，使用 `tmux switch -t <session_name>`在不同会话间切换。

   - **窗格分割**：在一个 Tmux 会话内，您可以按 `Ctrl`+ `b`，再按 `%`来垂直分割窗格，或按 `"`来水平分割窗格。这允许您在一个窗口内同时进行多项操作，比如一边编辑代码一边查看日志

   - **创建新窗口**：按 `Ctrl`+ `b`，再按 `c`可以在一个会话内创建全新的完整终端窗口，就像浏览器的新标签页一样，方便组织工作流程


在 Tmux 中完成窗格分割后，有几种非常便捷的方法可以在窗格之间切换光标。

| **操作类型**   | **快捷键/命令**                         | **说明**                                               |
| :------------- | :-------------------------------------- | :----------------------------------------------------- |
| **方向键切换** | `Ctrl`+ `b`，松开后按**方向键**（↑↓←→） | 最直观的方法，光标会移动到相邻窗格。                   |
| **顺序切换**   | `Ctrl`+ `b`，松开后按 `o`               | 按顺序切换到下一个窗格。                               |
| **快捷键切换** | `Ctrl`+ `b`，松开后按 `;`               | 切换到**上一次活跃**的窗格，适合在两个窗格间快速切换。 |
| **命令行切换** | `tmux select-pane -[U                   | D                                                      |


### 💡 增强稳定性的补充设置

为了获得极致稳定的体验，还可以将 Tmux 与 SSH 客户端自身的保活设置结合使用：

在本地电脑的 SSH 客户端配置文件（通常是 `~/.ssh/config`）中，添加以下配置：

```bash
Host *
    ServerAliveInterval 60
    ServerAliveCountMax 3
```

这样设置后，SSH 客户端会每分钟向服务器发送一次保活信号，帮助维持底层网络连接的活跃，减少因中间网络设备（如防火墙）超时设置导致的意外断开。
