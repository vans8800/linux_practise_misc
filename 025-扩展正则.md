## 背景命令
---

sed -ri 's/.*swap.*/#&/' xxx.sh

## 理解扩展正则

### 扩展正则（ERE）在这里是什么意思

- 在 sed 中，`-r`（GNU sed）或 `-E`（BSD/macOS sed）开启的是扩展正则表达式 ERE（Extended Regular Expressions）。

- 与基础正则 BRE 相比，ERE 允许直接使用 `+ ? | () {}` 等元字符，而无需反斜杠转义。

### 和这条命令的关系

- 命令：`sed -ri 's/.*swap.*/#&/' file`

- 模式 `.*swap.*` 本身不依赖 ERE 特性（BRE 也能用），所以这里用不用 `-r` 都可以。

- 开启 ERE 只是“更方便写更复杂的正则”，但此处没用到。

### 什么时候必须用扩展正则

- 需要这些能力时：
  - `+`（一次或多次）、`?`（零次或一次）、`|`（或）、`()`（分组）、`{m,n}`（重复）

例子（ERE 才能这样简写；BRE 里要大量反斜杠）：

```bash
  sed -E 's/(cat|dog)+s?/animal/g'
  
  sed -E 's/foo {2,4}bar/FOO-BAR/'
  
  sed -E 's/^([[:alpha:]]+)[[:space:]]+(.+)$/\2 \1/'
  
  ```

### 小提示

- GNU sed 推荐用 `-E`，`-r` 仍可用但较旧。

- sed 不支持 `\s` 这类 PCRE 元字符，用 `[[:space:]]` 等 POSIX 字符类：
  - `[[:digit:]] [[:alpha:]] [[:alnum:]] [[:space:]] [[:punct:]]` 等。

结论：本例的 `.*swap.*` 不需要扩展正则；但加 `-r/-E` 为将来写更复杂模式提供便利。


